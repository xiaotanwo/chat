webpackJsonp([1],{J373:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{attrs:{id:"app"}},[e("router-view")],1)])},staticRenderFns:[]};var a=s("VU/8")({name:"App"},o,!1,function(t){s("QL+B")},null,null).exports,r=s("/ocq"),n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content",staticStyle:{"background-color":"rgb(179, 216, 255)"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:20,offset:2}},[s("div",{staticClass:"grid-content"},[s("h1",[t._v("\n                                聊天室 —— 登录\n                            ")])])])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14,offset:5}},[s("div",[s("el-input",{attrs:{placeholder:"请输入昵称",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toLogin(e)}},model:{value:t.input_name,callback:function(e){t.input_name=e},expression:"input_name"}})],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14,offset:5}},[s("div",[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toLogin(e)}},model:{value:t.input_password,callback:function(e){t.input_password=e},expression:"input_password"}})],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:16,offset:4}},[s("div",{staticClass:"grid-content"},[s("el-button",{attrs:{type:"primary",loading:this.load,round:""},on:{click:t.toLogin}},[t._v("\n                              "+t._s(t.login_tip)+"\n                            ")]),t._v(" "),s("el-button",{attrs:{type:"success",round:""},on:{click:t.toRegister}},[t._v("\n                              注册\n                            ")])],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1)],1)])],1)],1)},staticRenderFns:[]},l=s("VU/8")({data:function(){return{input_name:"",input_password:"",slat:"1a2b3c4d",load:!1,login_tip:"登录"}},methods:{toRegister:function(){this.$router.replace("/register")},toLogin:function(){var t=this;this.input_name=this.input_name.trim(),this.input_password=this.input_password.trim(),this.trueName(this.input_name)?this.truePassword(this.input_password)?(this.load=!0,this.login_tip="登录中...",this.$http.post("http://localhost/user/login",{name:this.input_name,password:this.$md5(this.slat[0]+this.slat[2]+this.input_password+this.slat[5]+this.slat[4])}).then(function(e){e.data.ret?(t.alertSuccess("登录成功！"),t.$router.replace({path:"/chat",query:{username:t.input_name}})):t.alertError(e.data.msg),t.load=!1,t.login_tip="登录"}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！"),t.load=!1,t.login_tip="登录"})):this.alertError("密码长度只允许6至18位!"):this.alertError("昵称长度只允许2至10位!")},trueName:function(t){return t.length>=2&&t.length<=10},truePassword:function(t){return t.length>=6&&t.length<=18},alertError:function(t){this.$message.error({message:t,center:!0})},alertSuccess:function(t){this.$message.success({message:t,center:!0})}}},n,!1,null,null,null).exports,c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content",staticStyle:{"background-color":"rgb(179, 216, 255)"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:20,offset:2}},[s("div",{staticClass:"grid-content"},[s("h1",[t._v("\n                                聊天室 —— 注册\n                            ")])])])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14,offset:5}},[s("div",[s("el-input",{attrs:{placeholder:"请输入昵称",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toRegister(e)}},model:{value:t.input_name,callback:function(e){t.input_name=e},expression:"input_name"}})],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14,offset:5}},[s("div",[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toRegister(e)}},model:{value:t.input_password,callback:function(e){t.input_password=e},expression:"input_password"}})],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:14,offset:5}},[s("div",[s("el-input",{attrs:{placeholder:"请再次输入密码","show-password":""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toRegister(e)}},model:{value:t.input_password_second,callback:function(e){t.input_password_second=e},expression:"input_password_second"}})],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:16,offset:4}},[s("div",{staticClass:"grid-content"},[s("el-button",{attrs:{type:"primary",round:""},on:{click:t.toLogin}},[t._v("\n                              登录\n                            ")]),t._v(" "),s("el-button",{attrs:{type:"success",loading:this.load,round:""},on:{click:t.toRegister}},[t._v("\n                              "+t._s(t.register_tips)+"\n                            ")])],1)])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1)],1)])],1)],1)},staticRenderFns:[]},u=s("VU/8")({data:function(){return{input_name:"",input_password:"",input_password_second:"",slat:"1a2b3c4d",load:!1,register_tips:"注册"}},methods:{toLogin:function(){this.$router.replace("/login")},toRegister:function(){var t=this;this.input_name=this.input_name.trim(),this.input_password=this.input_password.trim(),this.input_password_second=this.input_password_second.trim(),this.trueName(this.input_name)?this.input_password===this.input_password_second?this.truePassword(this.input_password)?(this.load=!0,this.register_tips="注册中...",this.$http.post("http://localhost/user/register",{name:this.input_name,password:this.$md5(this.slat[0]+this.slat[2]+this.input_password+this.slat[5]+this.slat[4])}).then(function(e){e.data.ret?(t.alertSuccess("注册成功！"),t.$router.replace({path:"/chat",query:{username:t.input_name}})):t.alertError(e.data.msg),t.load=!1,t.register_tips="注册"}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！"),t.load=!1,t.register_tips="注册"})):this.alertError("密码长度只允许6至18位!"):this.alertError("两次输入的密码不一致！"):this.alertError("昵称长度只允许2至10位!")},trueName:function(t){return t.length>=2&&t.length<=10},truePassword:function(t){return t.length>=6&&t.length<=18},alertError:function(t){this.$message.error({message:t,center:!0})},alertSuccess:function(t){this.$message.success({message:t,center:!0})}}},c,!1,null,null,null).exports,p=s("mvHQ"),h=s.n(p),d=s("Y50r"),m={components:{Avatar:s.n(d).a},created:function(){this.username=this.$route.query.username,this.headname=this.username[0]+" "+this.username[1],this.init(),this.initWebpack();var t=this;this.updatetimer=setInterval(function(){t.$http.get("http://localhost/updateSession").then(function(t){})},3e4)},updated:function(){var t=document.getElementById("scrollDiv");t.scrollTop=t.scrollHeight},data:function(){return{slat:"1a2b3c4d",chatTitle:"聊天室",username:"",headname:"",outConnecting:!0,chatText:"",chatType:-1,shiftFlag:!1,friendList:[],groupList:[],roomList:["一二三四五六七八九十","北京","上海","广州","深圳","北京","上海","广州","深圳","北京","上海","广州","深圳"],addFriendDialogVisible:!1,friendApplyDialogVisible:!1,newGroupDialogVisible:!1,joinGroupDialogVisible:!1,friendsDialogVisible:!1,addFriendForm:{applyName:"",msg:""},newGroupForm:{name:"",password:""},joinGroupForm:{name:"",password:""},formLabelWidth:"120px",friendApplyTableData:[],friendsTableData:[],info:"",ws:null,lockReconnect:!1,timeout:1e4,timeoutObj:null,serverTimeoutObj:null,timeoutnum:null,logout_flag:!1,updatetimer:null,pictureData:{msgType:-1,msgToName:""}}},methods:{init:function(){var t=this;this.$http.get("http://localhost/friendApply/search").then(function(e){e.data.ret?t.friendApplyTableData=e.data.obj:t.alertError(e.data.msg)}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！")})},initWebpack:function(){"undefined"!=typeof WebSocket?(this.ws=new WebSocket("ws://localhost/chat"),this.ws.onopen=this.onopen,this.ws.onmessage=this.onmessage,this.ws.onclose=this.onclose,this.ws.onerror=this.onerror):alert("您的浏览器不支持socket！请更换浏览器！")},reconnect:function(){var t=this;t.lockReconnect||(t.lockReconnect=!0,t.timeoutnum&&clearTimeout(t.timeoutnum),t.timeoutnum=setTimeout(function(){t.initWebpack(),t.lockReconnect=!1},5e3))},reset:function(){clearTimeout(this.timeoutObj),clearTimeout(this.serverTimeoutObj),this.start()},start:function(){var t=this;t.timeoutObj&&clearTimeout(t.timeoutObj),t.serverTimeoutObj&&clearTimeout(t.serverTimeoutObj),t.timeoutObj=setTimeout(function(){1==t.ws.readyState?t.ws.send("ping"):t.reconnect(),t.serverTimeoutObj=setTimeout(function(){t.ws.close()},t.timeout)},t.timeout)},onopen:function(){this.outConnecting=!1,this.start()},onmessage:function(t){if(this.reset(),"pang"!=t.data){var e=JSON.parse(t.data),s=parseInt(e.type/10),i=e.type%10;switch(s){case 0:switch(i){case 0:this.roomList=e.obj;break;case 1:var o=sessionStorage.getItem(0+e.toName),a=this.infoToHtml(e.fromName,0,e.obj),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(0+e.toName,r),0==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 2:o=sessionStorage.getItem(0+e.toName),a=this.infoToHtml(e.fromName,1,e.obj),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(0+e.toName,r),0==this.chatType&&this.chatTitle==e.toName&&(this.info=r)}break;case 1:switch(i){case 0:this.groupList=e.obj;break;case 1:o=sessionStorage.getItem(1+e.toName),a=this.showTip(e.fromName+" 上线了"),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 2:o=sessionStorage.getItem(1+e.toName),a=this.infoToHtml(e.fromName,0,e.obj),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 3:o=sessionStorage.getItem(1+e.toName),a=this.showTip(e.fromName+" 下线了"),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 4:o=sessionStorage.getItem(1+e.toName),a=this.showTip(e.fromName+" 加入了群聊"),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 5:o=sessionStorage.getItem(1+e.toName),a=this.showTip(e.fromName+" 退出了群聊"),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r),console.log("nihhao");break;case 6:o=sessionStorage.getItem(1+e.toName),a=this.infoToHtml(e.fromName,1,e.obj),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(1+e.toName,r),1==this.chatType&&this.chatTitle==e.toName&&(this.info=r)}break;case 2:switch(i){case 0:this.friendsTableData=e.obj;break;case 1:this.friendList=e.obj;break;case 2:-1==this.friendList.indexOf(e.fromName)&&this.friendList.push(e.fromName);break;case 3:o=sessionStorage.getItem(2+e.fromName),a=this.infoToHtml(e.fromName,0,e.obj),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(2+e.fromName,r),2==this.chatType&&this.chatTitle==e.fromName&&(this.info=r);break;case 4:o=sessionStorage.getItem(2+e.toName),a=this.showTip(e.toName+" 已下线"),r="";null!=o&&(r+=o),r+=a,sessionStorage.setItem(2+e.toName,r),2==this.chatType&&this.chatTitle==e.toName&&(this.info=r);break;case 5:(n=this.friendList.indexOf(e.fromName))>=0&&this.friendList.splice(n,1);break;case 6:this.friendApplyTableData.push({name:e.fromName,msg:e.obj});break;case 7:this.friendList.push(e.fromName),this.friendsTableData.push({friend:e.fromName});break;case 8:for(var n=-1,l=0;l<this.friendsTableData.length;++l)if(this.friendsTableData[l].friend==e.fromName){n=l;break}n>=0&&this.friendsTableData.splice(n,1);break;case 9:o="";o=this.username==e.fromName?sessionStorage.getItem(2+e.toName):sessionStorage.getItem(2+e.fromName);a=this.infoToHtml(e.fromName,1,e.obj),r="";null!=o&&(r+=o),r+=a,this.username==e.fromName?(sessionStorage.setItem(2+e.toName,r),2==this.chatType&&this.chatTitle==e.toName&&(this.info=r)):(sessionStorage.setItem(2+e.fromName,r),2==this.chatType&&this.chatTitle==e.fromName&&(this.info=r))}}}},onclose:function(){this.outConnecting=!0,this.ws=null,this.logout_flag||this.reconnect()},onerror:function(){this.outConnecting=!0,this.ws=null,this.logout_flag||this.reconnect()},logout:function(){var t=this;this.logout_flag=!0,null!=this.ws&&this.ws.close(),this.$http.get("http://localhost/user/logout").then(function(e){e.data.ret?t.alertSuccess(e.data.msg):t.alertError(e.data.msg),sessionStorage.clear(),t.updatetimer&&clearTimeout(t.updatetimer),t.$router.replace("/login")}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！")})},addFriend:function(){var t=this;this.addFriendForm.applyName=this.addFriendForm.applyName.trim(),this.addFriendForm.msg=this.addFriendForm.msg.trim(),this.trueName(this.addFriendForm.applyName)?this.addFriendForm.msg.length>50?this.alertError("申请信息长度不能超过50!"):this.$http.post("http://localhost/friendApply/add",{applyName:this.addFriendForm.applyName,msg:this.addFriendForm.msg}).then(function(e){e.data.ret?(t.alertSuccess(e.data.msg),t.addFriendForm.applyName="",t.addFriendForm.msg=""):t.alertError(e.data.msg)}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！")}):this.alertError("名称长度在2至10位!")},addFriendClose:function(){this.addFriendDialogVisible=!1,this.addFriendForm.applyName="",this.addFriendForm.msg=""},agreeFriendApply:function(t,e){var s=this;this.$http.get("http://localhost/friendApply/agree/"+e[t].name).then(function(i){i.data.ret?(s.alertSuccess("已同意该好友的申请！"),"已是好友！"!=i.data.msg&&s.friendsTableData.push({friend:e[t].name}),e.splice(t,1)):s.alertError(i.data.msg)}).catch(function(t){s.alertError("网络出现故障，请稍后再尝试！")})},refuseFriendApply:function(t,e){var s=this;this.$http.get("http://localhost/friendApply/refuse/"+e[t].name).then(function(i){i.data.ret?(s.alertSuccess("已拒绝该好友的申请！"),e.splice(t,1)):s.alertError(i.data.msg)}).catch(function(t){s.alertError("网络出现故障，请稍后再尝试！")})},deleteFriend:function(t,e){var s=this;this.$http.get("http://localhost/friend/delete/"+e[t].friend).then(function(i){i.data.ret?(s.alertSuccess("双向删除好友成功！"),e.splice(t,1)):s.alertError(i.data.msg)}).catch(function(t){s.alertError("网络出现故障，请稍后再尝试！")})},newGroup:function(){var t=this;this.newGroupForm.name=this.newGroupForm.name.trim(),this.newGroupForm.password=this.newGroupForm.password.trim(),this.trueName(this.newGroupForm.name)?this.truePassword(this.newGroupForm.password)?this.$http.post("http://localhost/group/newGroup",{name:this.newGroupForm.name,password:this.$md5(this.slat[0]+this.slat[2]+this.newGroupForm.password+this.slat[5]+this.slat[4])}).then(function(e){e.data.ret?(t.alertSuccess("新建群聊："+t.newGroupForm.name+" 成功!"),t.groupList.push(t.newGroupForm.name),t.newGroupForm.name="",t.newGroupForm.password=""):t.alertError(e.data.msg)}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！")}):this.alertError("密码长度在6至18位!"):this.alertError("群聊名长度在2至10位!")},newGroupClose:function(){this.newGroupDialogVisible=!1,this.newGroupForm.name="",this.newGroupForm.password=""},joinGroup:function(){var t=this;this.joinGroupForm.name=this.joinGroupForm.name.trim(),this.joinGroupForm.password=this.joinGroupForm.password.trim(),this.trueName(this.joinGroupForm.name)?this.truePassword(this.joinGroupForm.password)?this.$http.post("http://localhost/groupMember/joinGroup",{name:this.joinGroupForm.name,password:this.$md5(this.slat[0]+this.slat[2]+this.joinGroupForm.password+this.slat[5]+this.slat[4])}).then(function(e){e.data.ret?(t.alertSuccess("加入群聊："+t.joinGroupForm.name+" 成功!"),t.groupList.push(t.joinGroupForm.name),t.joinGroupForm.name="",t.joinGroupForm.password=""):t.alertError(e.data.msg)}).catch(function(e){t.alertError("网络出现故障，请稍后再尝试！")}):this.alertError("密码长度在6至18位!"):this.alertError("群聊名长度在2至10位!")},joinGroupClose:function(){this.joinGroupDialogVisible=!1,this.joinGroupForm.name="",this.joinGroupForm.password=""},getAvatar:function(t){return'<div style="margin: 0 0 10px 0"><div aria-hidden="true" class="vue-avatar--wrapper" style="display: inline-flex; width: 50px; height: 50px; border-radius: 50%; font: 20px / 50px Helvetica, Arial, sans-serif; align-items: center; justify-content: center; text-align: center; user-select: none; background-color: #DCDFE6; vertical-align: middle;"><span>'+t.substring(0,2)+"</span></div></div>"},getMsg:function(t,e){return"<div style='text-align: "+e+"; padding: 3px; margin: 3px'>"+t+"</div>"},getImg:function(t,e){return"<div style='text-align: "+e+'; padding: 3px; margin: 3px\'><img height="120px" src="http://localhost/img/'+t+'" /></div>'},infoToHtml:function(t,e,s){var i="";return t==this.username?(i="<div style='margin: 2px 5px 2px 52px; display: flex; justify-content: flex-end; align-items: flex-start;'>",i+=0==e?this.getMsg(s,"right"):this.getImg(s,"right"),i+=this.getAvatar(t)+"</div>"):(i="<div style='margin: 2px 52px 2px 5px ; display: flex; justify-content: flex-start; align-items: flex-start;'>"+this.getAvatar(t),i+=0==e?this.getMsg(s,"left"):this.getImg(s,"left"),i+="</div>"),i},showTip:function(t){return'<div><span style="color: #F56C6C">'+t+"</span></div>"},handleCommand:function(t){var e=this;"close"==t?(this.$refs.elMenu.activeIndex=null,this.chatTitle="聊天室",this.chatType=-1,this.info="",this.pictureData.msgType=-1,this.pictureData.msgToName=""):"delete"==t&&(1==this.chatType?this.$http.get("http://localhost/groupMember/delete/"+this.chatTitle).then(function(t){if(t.data.ret){var s=e.groupList.indexOf(e.chatTitle);s>=0&&e.groupList.splice(s,1),e.alertSuccess("群聊删除成功！"),e.$refs.elMenu.activeIndex=null,e.chatTitle="聊天室",e.chatType=-1,e.info="",e.pictureData.msgType=-1,e.pictureData.msgToName=""}else e.alertError(t.data.msg)}).catch(function(t){e.alertError("网络出现故障，请稍后再尝试！")}):2==this.chatType?this.$http.get("http://localhost/friend/delete/"+this.chatTitle).then(function(t){if(t.data.ret){var s=e.friendList.indexOf(e.chatTitle);s>=0&&e.friendList.splice(s,1),s=-1;for(var i=0;i<e.friendsTableData.length;++i)if(e.friendsTableData[i].friend==e.chatTitle){s=i;break}s>=0&&e.friendsTableData.splice(s,1),e.alertSuccess("好友删除成功！"),e.$refs.elMenu.activeIndex=null,e.chatTitle="聊天室",e.chatType=-1,e.info="",e.pictureData.msgType=-1,e.pictureData.msgToName=""}else e.alertError(t.data.msg)}).catch(function(t){e.alertError("网络出现故障，请稍后再尝试！")}):this.alertError("不能对此页面进行删除！"))},chatInRoom:function(t){this.chatTitle=t,this.chatType=0,this.info=sessionStorage.getItem(this.chatType+this.chatTitle),null==this.info&&(this.info=""),this.pictureData.msgType=0,this.pictureData.msgToName=t},chatInGroup:function(t){this.chatTitle=t,this.chatType=1,this.info=sessionStorage.getItem(this.chatType+this.chatTitle),null==this.info&&(this.info=""),this.pictureData.msgType=1,this.pictureData.msgToName=t},chatWithFriend:function(t){this.chatTitle=t,this.chatType=2,this.info=sessionStorage.getItem(this.chatType+this.chatTitle),null==this.info&&(this.info=""),this.pictureData.msgType=2,this.pictureData.msgToName=t},toSend:function(t){if(this.shiftFlag||13!=t.keyCode)16==t.keyCode&&(this.shiftFlag=!1);else{if(-1==this.chatType)return void this.alertError("请选择聊天对象！");if(this.outConnecting)return void this.alertError("您已断开连接，请检查网络或重新登录！");if(this.chatText=this.chatText.trim(),""==this.chatText)return void this.alertError("聊天信息不嫩为空！");var e=this.chatText.replace(/(\r\n)|(\n)/g,"<br>"),s=this.infoToHtml(this.username,0,e);this.info+=s,sessionStorage.setItem(this.chatType+this.chatTitle,this.info),this.chatText="";var i={type:this.chatType,toName:this.chatTitle,obj:e};this.ws.send(h()(i))}},handlePictureSuccess:function(t,e){t.ret?this.alertSuccess(t.msg):this.alertError(t.msg)},beforePictureUpload:function(t){var e="image/jpeg"===t.type,s=t.size/1024/1024<1;return e||this.alertError("发送图片只能是 JPG 格式!"),s||this.alertError("发送图片大小不能超过 1MB!"),e&&s},downshift:function(){this.shiftFlag=!0},trueName:function(t){return t.length>=2&&t.length<=10},truePassword:function(t){return t.length>=6&&t.length<=18},alertError:function(t){this.$message.error({message:t,center:!0})},alertSuccess:function(t){this.$message.success({message:t,center:!0})}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-dialog",{attrs:{title:"添加好友",visible:t.addFriendDialogVisible,width:"400px",top:"200px","close-on-click-modal":!1,"show-close":!1,center:""},on:{"update:visible":function(e){t.addFriendDialogVisible=e}}},[s("el-form",{attrs:{model:t.addFriendForm}},[s("el-form-item",{attrs:{label:"好友名称：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入对方名称"},model:{value:t.addFriendForm.applyName,callback:function(e){t.$set(t.addFriendForm,"applyName",e)},expression:"addFriendForm.applyName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"申请信息：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入申请消息"},model:{value:t.addFriendForm.msg,callback:function(e){t.$set(t.addFriendForm,"msg",e)},expression:"addFriendForm.msg"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"danger"},on:{click:t.addFriendClose}},[t._v("关 闭")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.addFriend}},[t._v("申 请")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"好友申请列表",visible:t.friendApplyDialogVisible,width:"700px",top:"200px",center:""},on:{"update:visible":function(e){t.friendApplyDialogVisible=e}}},[s("el-table",{attrs:{data:t.friendApplyTableData}},[s("el-table-column",{attrs:{prop:"name",label:"用户",width:"160"}}),t._v(" "),s("el-table-column",{attrs:{prop:"msg",label:"申请信息"}}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"146"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){return t.agreeFriendApply(e.$index,t.friendApplyTableData)}}},[t._v("同意")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return t.refuseFriendApply(e.$index,t.friendApplyTableData)}}},[t._v("拒绝")])]}}])})],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"好友列表",visible:t.friendsDialogVisible,width:"400px",top:"200px",center:""},on:{"update:visible":function(e){t.friendsDialogVisible=e}}},[s("el-table",{attrs:{data:t.friendsTableData}},[s("el-table-column",{attrs:{prop:"friend",label:"好友名称"}}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"76"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return t.deleteFriend(e.$index,t.friendsTableData)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"新建群聊",visible:t.newGroupDialogVisible,width:"400px",top:"200px","close-on-click-modal":!1,"show-close":!1,center:""},on:{"update:visible":function(e){t.newGroupDialogVisible=e}}},[s("el-form",{attrs:{model:t.newGroupForm}},[s("el-form-item",{attrs:{label:"群聊名称：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入群聊名称"},model:{value:t.newGroupForm.name,callback:function(e){t.$set(t.newGroupForm,"name",e)},expression:"newGroupForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"群聊密码：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入群聊密码","show-password":""},model:{value:t.newGroupForm.password,callback:function(e){t.$set(t.newGroupForm,"password",e)},expression:"newGroupForm.password"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"danger"},on:{click:t.newGroupClose}},[t._v("关 闭")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.newGroup}},[t._v("新 建")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"加入群聊",visible:t.joinGroupDialogVisible,width:"400px",top:"200px","close-on-click-modal":!1,"show-close":!1,center:""},on:{"update:visible":function(e){t.joinGroupDialogVisible=e}}},[s("el-form",{attrs:{model:t.joinGroupForm}},[s("el-form-item",{attrs:{label:"群聊名称：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入群聊名称"},model:{value:t.joinGroupForm.name,callback:function(e){t.$set(t.joinGroupForm,"name",e)},expression:"joinGroupForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"群聊密码：","label-width":t.formLabelWidth}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入群聊密码","show-password":""},model:{value:t.joinGroupForm.password,callback:function(e){t.$set(t.joinGroupForm,"password",e)},expression:"joinGroupForm.password"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"danger"},on:{click:t.joinGroupClose}},[t._v("关 闭")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.joinGroup}},[t._v("加 入")])],1)],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8,offset:8}},[s("div",{staticClass:"grid-content"})])],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{border:"1px solid"},attrs:{span:16,offset:4}},[s("el-container",{staticStyle:{height:"700px",opacity:"0.9"}},[s("el-container",{staticStyle:{height:"100%",width:"260px"}},[s("el-header",[s("Avatar",{staticStyle:{"vertical-align":"middle"},attrs:{username:t.headname,"background-color":"#DCDFE6",color:"black",inline:!0}}),t._v(" "),t.outConnecting?s("el-tag",{staticStyle:{border:"0",color:"#F56C6C","font-size":"17px",margin:"0 auto"}},[t._v("\n                            --离线中--\n                        ")]):t._e()],1),t._v(" "),s("el-main",{staticStyle:{margin:"5px 0",padding:"0"}},[s("el-col",[s("el-menu",{ref:"elMenu",staticClass:"el-menu-vertical-demo",staticStyle:{"text-align":"left","border-right":"0"},attrs:{"default-active":"2","text-color":"black","active-text-color":"#F56C6C","unique-opened":!0}},[s("el-submenu",{attrs:{index:"1"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-s-home",staticStyle:{color:"#F56C6C"}}),t._v(" "),s("span",[t._v("聊天室")])]),t._v(" "),t._l(t.roomList,function(e,i){return s("el-menu-item",{key:i,attrs:{index:"1-"+i},on:{click:function(s){return t.chatInRoom(e)}}},[t._v("\n                                        "+t._s(e)+"\n                                    ")])})],2),t._v(" "),s("el-submenu",{attrs:{index:"2"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-star-on",staticStyle:{color:"#F56C6C"}}),t._v(" "),s("span",[t._v("群聊")])]),t._v(" "),s("el-menu-item",{staticStyle:{color:"#409EFF"},on:{click:function(e){t.newGroupDialogVisible=!0}}},[t._v("新建群聊")]),t._v(" "),s("el-menu-item",{staticStyle:{color:"#409EFF"},on:{click:function(e){t.joinGroupDialogVisible=!0}}},[t._v("加入群聊")]),t._v(" "),t._l(t.groupList,function(e,i){return s("el-menu-item",{key:i,attrs:{index:"2-"+i},on:{click:function(s){return t.chatInGroup(e)}}},[t._v("\n                                        "+t._s(e)+"\n                                    ")])})],2),t._v(" "),s("el-submenu",{attrs:{index:"3"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-user-solid",staticStyle:{color:"#F56C6C"}}),t._v(" "),s("span",[t._v("好友")])]),t._v(" "),s("el-menu-item",{staticStyle:{color:"#409EFF"},on:{click:function(e){t.addFriendDialogVisible=!0}}},[t._v("添加好友")]),t._v(" "),s("el-menu-item",{staticStyle:{color:"#409EFF"},on:{click:function(e){t.friendApplyDialogVisible=!0}}},[t._v("好友申请")]),t._v(" "),s("el-menu-item",{staticStyle:{color:"#409EFF"},on:{click:function(e){t.friendsDialogVisible=!0}}},[t._v("好友列表")]),t._v(" "),t._l(t.friendList,function(e,i){return s("el-menu-item",{key:i,attrs:{index:"3-"+i},on:{click:function(s){return t.chatWithFriend(e)}}},[t._v("\n                                        "+t._s(e)+"\n                                    ")])})],2)],1)],1)],1),t._v(" "),s("el-footer",{staticStyle:{"padding-top":"10px"}},[s("el-button",{attrs:{type:"danger",round:""},on:{click:t.logout}},[t._v("退出")])],1)],1),t._v(" "),s("el-container",{staticStyle:{width:"85%"}},[s("el-header",{staticStyle:{"text-align":"center"}},[s("el-dropdown",{on:{command:t.handleCommand}},[s("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#F56C6C","font-size":"20px"}},[t._v("\n                                "+t._s(t.chatTitle)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{staticStyle:{"background-color":"Gainsboro"},attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{staticStyle:{color:"#F56C6C"},attrs:{icon:"el-icon-error",command:"close"}},[t._v("关闭")]),t._v(" "),s("el-dropdown-item",{staticStyle:{color:"#F56C6C"},attrs:{icon:"el-icon-delete-solid",command:"delete"}},[t._v("删除")])],1)],1)],1),t._v(" "),s("el-main",{staticStyle:{margin:"5px 10px"},attrs:{id:"scrollDiv"}},[s("div",{domProps:{innerHTML:t._s(t.info)}})]),t._v(" "),s("el-footer",{staticStyle:{height:"130px",padding:"5px 10px"}},[s("el-row",[s("el-col",{attrs:{span:22}},[s("el-input",{attrs:{maxlength:"300",resize:"none",type:"textarea",rows:5,placeholder:"请输入聊天内容。 Enter 发送，Shift + Enter 换行"},nativeOn:{keyup:function(e){return t.toSend(e)},keydown:function(e){return e.shiftKey?t.downshift(e):null}},model:{value:t.chatText,callback:function(e){t.chatText=e},expression:"chatText"}})],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("el-upload",{attrs:{action:"http://localhost/picture/upload","show-file-list":!1,"on-success":t.handlePictureSuccess,"before-upload":t.beforePictureUpload,data:t.pictureData,"with-credentials":!0}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-picture-outline",circle:""}})],1)],1)],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},g=s("VU/8")(m,f,!1,null,null,null).exports;i.default.use(r.a);var v=new r.a({routes:[{path:"/",component:l},{path:"/login",component:l},{path:"/register",component:u},{path:"/chat",component:g}]}),b=s("zL8q"),w=s.n(b),_=(s("tvR6"),s("mtWM")),y=s.n(_),F=s("NC6I"),T=s.n(F);s("J373");i.default.config.productionTip=!1,i.default.use(w.a),i.default.prototype.$http=y.a,y.a.defaults.withCredentials=!0,i.default.prototype.$md5=T.a,new i.default({el:"#app",router:v,components:{App:a},template:"<App/>"})},"QL+B":function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.c22fa0aab8862c4907d1.js.map